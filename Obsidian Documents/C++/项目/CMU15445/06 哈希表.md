
页表中用到了hash table

整个课程的架构
![](Pasted%20image%2020230320230301.png)
disk manager：存储引擎
buffer pool manager：缓存池
access methods：哈希表 b+树


hash table是一种访问方法。数据库索引方法。

数据结构使用场景：
![](Pasted%20image%2020230320230534.png)
表索引一般用b+不用哈希，因为表索引会涉及大量范围查询
![](Pasted%20image%2020230320230635.png)
数据结构设计时考虑问题：
1. 数据结构
2. 并发问题




哈希表中没有顺序这种说法
![](Pasted%20image%2020230320230757.png)
键值对，根据给的key使用hash function计算value所在数组中的位置。
最差情况：key全部冲突O（n）

![](Pasted%20image%2020230320231232.png)
![](Pasted%20image%2020230320231244.png)
假设使用完美哈希函数（无哈希碰撞）



![](Pasted%20image%2020230320231324.png)

# 本节课任务
![](Pasted%20image%2020230320231606.png)
- hash函数
- 静态hash模式
- 动态hash模式

# hash functions

![](Pasted%20image%2020230320231636.png)
哈希函数不加密。希望速度快，碰撞率低。
![](Pasted%20image%2020230520015100.png)

# 静态哈希策略（解决哈希碰撞）

![](Pasted%20image%2020230320232312.png)


## LINEAR PROBE HASHING 
开放地址哈希（线性探测）
![](Pasted%20image%2020230320232532.png)

### 问题

1. slot中需要存key的值
![](Pasted%20image%2020230320232717.png)
![](Pasted%20image%2020230320232802.png)
2. 删除时会出现的问题

![](Pasted%20image%2020230320232851.png)
解决方案：
	1. 墓碑：设个标记，标记这里本来有人，但是删除了
	2. 整理：删除后整理一遍队列

### 重复键，非唯一键出苦力

hashmap不允许，数据库索引允许
两种解决办法
![](Pasted%20image%2020230320233241.png)

## ROBIN HOOD HASHING

罗宾汉，劫富济贫
加个标志位，表示往后退了几格，也是线性探测
![](Pasted%20image%2020230320233421.png)
选择标记最小的方案

## CUCKOO HASHING

杜鹃鸟哈希

使用多个hash表，空间换时间
![](Pasted%20image%2020230320233707.png)
![](Pasted%20image%2020230320233800.png)
碰撞时选择另一个不碰撞的表
![](Pasted%20image%2020230320233904.png)
c取代b，b取代a，a使用hash2发现不碰撞

# 思考
![](Pasted%20image%2020230320234122.png)
思考：这三种解决哈希碰撞方式的问题。一旦超过容量，要扩容，即迁移整张表。key的数量最好提前知道来最小化hash碰撞
哈希数组时固定的（静态的）

# 动态哈希策略（解决哈希碰撞）

不重建hash table的情况下进行hash table动态扩容。

## 拉链法

java HashMap默认采用方案
![](Pasted%20image%2020230320234212.png)
引入桶的概念，不再是一个槽
![](Pasted%20image%2020230320234317.png)
哈希槽是定的，桶是不固定的。
slot中存储指向bucket的指针

## 可扩展哈希

lab2中页表使用的数据结构。
数组大小不固定，bucket大小固定，数量不固定
![](Pasted%20image%2020230320234615.png)
![](Pasted%20image%2020230320234723.png)
![](Pasted%20image%2020230320234753.png)
![](Pasted%20image%2020230320234816.png)
global变为3，根据前三位去分。扩容桶指针而不是桶容量
![](Pasted%20image%2020230320234915.png)

## 线性哈希

![](Pasted%20image%2020230320235025.png)
![](Pasted%20image%2020230320235207.png)
很复杂，不太用掌握

# 总结

![](Pasted%20image%2020230320235615.png)
查询O(1)
哈希表一般不用于当表索引,不适用于范围查找，散列函数，不连续。